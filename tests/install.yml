---

- name: Install - Jessie
  hosts: jessie
  pre_tasks:
    - include: pre_tasks/docker.yml
  roles:
    - manala.docker
  post_tasks:
    - raw: "{{ 'echo \"' ~ item|to_yaml ~ '\"|goss -g - validate' }}"
      with_items:
        - package:
            docker-engine:
              installed: true
        - command:
            docker --version:
              exit-status: 0
              stdout:
                - Docker version

- name: Install - Wheezy
  hosts: wheezy
  pre_tasks:
    - include: pre_tasks/docker.yml
    - include: pre_tasks/backports.yml
  roles:
    - manala.docker
  post_tasks:
    - raw: "{{ 'echo \"' ~ item|to_yaml ~ '\"|goss -g - validate' }}"
      with_items:
        - package:
            docker-engine:
              installed: true
        - command:
            docker --version:
              exit-status: 0
              stdout:
                - Docker version
